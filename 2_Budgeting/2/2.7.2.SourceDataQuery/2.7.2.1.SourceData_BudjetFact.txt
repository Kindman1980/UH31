//Источник данных для статей расходов (без учета проектов Оборот Дт счетов 20,26,44, где статья  расходов указана в реквизите статьи затрат)

ВЫБРАТЬ
СтатьиЗатратДополнительныеРеквизиты.Ссылка КАК Ссылка
ПОМЕСТИТЬ ВТ_СтатьиЗатрат
ИЗ
Справочник.СтатьиЗатрат.ДополнительныеРеквизиты КАК СтатьиЗатратДополнительныеРеквизиты
ГДЕ
СтатьиЗатратДополнительныеРеквизиты.Свойство.Имя = "СтатьяДоходовИРасходов"
И СтатьиЗатратДополнительныеРеквизиты.Значение.Наименование ПОДОБНО &Значение
;
 
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
ХозрасчетныйОбороты.СуммаОборотДт КАК СуммаОборотДт
ПОМЕСТИТЬ ВТ_ГруппировкаПоРегистратору
ИЗ
ВТ_СтатьиЗатрат КАК ВТ_СтатьиЗатрат
ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Хозрасчетный.Обороты(&НачПериода, &КонПериода, Регистратор, счет.код В ("26", "44.01", "44.02"), , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
ПО ВТ_СтатьиЗатрат.Ссылка = ХозрасчетныйОбороты.Субконто1
ГДЕ
НЕ (ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.АвансовыйОтчет
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ТребованиеНакладная
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ПередачаМатериаловВЭксплуатацию)
 
ОБЪЕДИНИТЬ ВСЕ
 
ВЫБРАТЬ
ХозрасчетныйОбороты.СуммаОборотДт
ИЗ
ВТ_СтатьиЗатрат КАК ВТ_СтатьиЗатрат
ЛЕВОЕ СОЕДИНЕНИЕ РегистрБухгалтерии.Хозрасчетный.Обороты(&НачПериода, &КонПериода, Регистратор, счет.код = "20.01", , Организация = &Организация, , ) КАК ХозрасчетныйОбороты
ПО ВТ_СтатьиЗатрат.Ссылка = ХозрасчетныйОбороты.Субконто2
ГДЕ
НЕ (ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.АвансовыйОтчет
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ТребованиеНакладная
ИЛИ ХозрасчетныйОбороты.Регистратор ССЫЛКА Документ.ПередачаМатериаловВЭксплуатацию)
 
ОБЪЕДИНИТЬ ВСЕ
 
ВЫБРАТЬ
ФактПоБюджетамОбороты.СуммаУпрОборот
ИЗ
РегистрНакопления.ФактПоБюджетам.Обороты(
&НачПериода,
&КонПериода,
Регистратор,
Организация = &Организация
И СтатьяБюджета.Наименование ПОДОБНО &Значение) КАК ФактПоБюджетамОбороты
ГДЕ
(ФактПоБюджетамОбороты.Регистратор.ИсходныйДокумент ССЫЛКА Документ.ПоступлениеТоваровУслуг
ИЛИ ФактПоБюджетамОбороты.Регистратор.ИсходныйДокумент ССЫЛКА Документ.АвансовыйОтчет
ИЛИ ФактПоБюджетамОбороты.Регистратор.ИсходныйДокумент ССЫЛКА Документ.ТребованиеНакладная
ИЛИ ФактПоБюджетамОбороты.Регистратор.ИсходныйДокумент ССЫЛКА Документ.ПередачаМатериаловВЭксплуатацию)
;
 
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
СУММА(ВТ_ГруппировкаПоРегистратору.СуммаОборотДт) КАК СуммаОборотДт
ИЗ
ВТ_ГруппировкаПоРегистратору КАК ВТ_ГруппировкаПоРегистратору
